clear;

K=[
26244	0	-13122	6561000	0	0	0	0	;
0	8748000000	-6561000	2187000000	0	0	0	0	;
-13122	-6561000	26244	0	-13122	6561000	0	0	;
6561000	2187000000	0	8748000000	-6561000	2187000000	0	0	;
0	0	-13122	-6561000	26244	0	-13122	6561000	;
0	0	6561000	2187000000	0	8748000000	-6561000	2187000000	;
0	0	0	0	-13122	-6561000	26244	0	;
0	0	0	0	6561000	2187000000	0	8748000000	;

];

M=[
52	0	9	-2166.6667	0	0	0	0	;
0	1333333.333	2166.6667	-500000	0	0	0	0	;
9	2166.6667	52	0	9	-2166.6667	0	0	;
-2166.6667	-500000	0	1333333.333	2166.6667	-500000	0	0	;
0	0	9	2166.6667	52	0	9	-2166.6667	;
0	0	-2166.6667	-500000	0	1333333.333	2166.6667	-500000	;
0	0	0	0	9	2166.6667	52	0	;
0	0	0	0	-2166.6667	-500000	0	1333333.333	;

];

Q=[
624	;
192000	;
5376	;
-768000	;
0	;
0	;
0	;
0	;

];

A=inv(M)*K;
[v,d]=eig(A);
myw=d.^(1/2);

E=200000;

I=5467500;

m=0.07;

L=5000;

w1=pi^2*sqrt(E*I/(m*L^4));
w2=4*w1;
w3=9*w1;


syms ww
KM=K-ww*M;
detKM=det(KM);
f=factor(detKM);
solveDet=solve(detKM);

XX=inv(K)*Q;

tw1=22.373/L^2*sqrt(E*I/m);
tw2=61.67/L^2*sqrt(E*I/m);

vw=[];
for i=8:-1:1;
    vw(8-i+1,1)=w(i,i);
end;